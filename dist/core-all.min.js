var typeOf=(function(){var a=(new Array).constructor,d=(new Date).constructor,b=(new RegExp).constructor;return function c(f){var e=typeof(f);if(e=="object"||e=="function"){if(f===null){return"null"}if(f.constructor==a){return"array"}if(f.constructor==d){return"date"}if(f.constructor==b){return"regexp"}}return e}})();function module(name,definition){var current_constructor,global=this,lastLogGroup=null;if(!global[name]){global[name]={}}var module_stack=[global[name]],module_path=[name];function current_module(){return module_stack[module_stack.length-1]}function push_module(name){if(!current_module()[name]){current_module()[name]={}}var module=current_module()[name];module_stack.push(module);module_path.push(name);return module}function pop_module(){module_stack.pop();module_path.pop()}function fullpath(name){return module_path.join(".")+"."+name}function clone(object){var cleaned={};for(var name in object){if(object.hasOwnProperty(name)){cleaned[name]=object[name]}}return cleaned}function synthesizeProp(name,klass,defaultValue){var intern="__"+name;if(!(intern in klass)){klass.define(intern,defaultValue)}klass.property(name,function get(){return this[intern]},function set(value){if(value!=this[intern]){var oldValue=this[intern];this[intern]=value;this.fire(":property:change",{sender:this,property:name,value:value,previous:oldValue})}})}var keywords={module:function(name,definition){var module=push_module(name);definition.call(module);pop_module()},klass:function(name,definition){current_constructor=function(){if(this.initialize){this.initialize.apply(this,arguments)}};var curr_ctor=current_constructor;current_constructor.displayName=name;current_constructor.className=fullpath(name);Object.defineProperty(current_constructor.prototype,"klass",{get:function(){return curr_ctor},writable:false,configurable:false,enumerable:true,});definition.call(current_constructor);this.include(module.coreMethods);current_module()[name]=current_constructor;current_constructor=undefined},subklass:function(parent,name,definition){current_constructor=function(){if(this.initialize){this.initialize.apply(this,arguments)}};current_constructor.prototype=clone(parent.prototype);for(var prop in clone(parent)){current_constructor[prop]=parent[prop]}var curr_ctor=current_constructor;current_constructor.displayName=name;current_constructor.className=fullpath(name);Object.defineProperty(current_constructor.prototype,"klass",{get:function(){return curr_ctor},writable:false,configurable:false,enumerable:true,});definition.call(current_constructor);this.include(module.coreMethods);current_module()[name]=current_constructor;current_constructor=undefined},include:function(mixin){for(var prop in mixin){current_constructor.prototype[prop]=mixin[prop]}},define:function(name,item){if(current_constructor){current_constructor.prototype[name]=item}else{current_module()[name]=item}},method:function(name,fn){this.define(name,fn)},ctor:function(fn){this.method("initialize",fn)},alias:function(oldName,newName){var fn=(current_constructor)?current_constructor.prototype[oldName]:current_module()[oldName];this.define(newName,fn)},staticMethod:function(name,fn){current_constructor[name]=fn},synthesize:function(){var props=Array.prototype.slice.call(arguments),self=this;if(props.length==1&&typeOf(props[0])=="object"){for(var name in props[0]){synthesizeProp(name,self,props[0][name])}}else{props.forEach(function(name,i){synthesizeProp(name,self)})}},property:function(name,fnGet,fnSet){if(!fnGet&&!fnSet){synthesizeProp(name,this)}else{this.get(name,fnGet);if(fnSet){this.set(name,fnSet)}}},get:function(name,fn){if(current_constructor){Object.defineProperty(current_constructor.prototype,name,{get:fn})}else{Object.defineProperty(current_module(),name,{get:fn})}},set:function(name,fn){if(current_constructor){Object.defineProperty(current_constructor.prototype,name,{set:fn})}else{Object.defineProperty(current_module(),name,{set:fn})}},log:function(){if(!module.debug){return}var caller_name=module_path.join(".");if(window.console&&console.log){if(caller_name&&console.group&&caller_name!=lastLogGroup){console.groupEnd();console.group(caller_name+" ("+(new Date()).getTime()+")");lastLogGroup=caller_name}var args=Array.prototype.slice.call(arguments);args.forEach(function(arg){console.log(arg)})}}};with(current_module()){with(keywords){eval("("+definition+")").call(current_module(),keywords)}}}module.debug=false;module.coreMethods={method:function(){var b=this,c=Array.prototype.slice.call(arguments),a=b[c.shift()];return function d(){return a.apply(b,c.concat(Array.prototype.slice.call(arguments)))}},callSuper:function(){},fire:function(a,b){},on:function(b,a){},stopOn:function(b,a){}};Array.from=function(a){if(a==null){return[]}if(typeOf(a)=="string"){return}return(Var.isEnumerable(a)&&typeof a!="string")?(typeOf(a)=="array")?a:Array.prototype.slice.call(a):(typeOf(a)=="string")?a.split(" "):[a]};if(!Array.prototype.forEach){Array.prototype.forEach=function(c,d){for(var b=0,a=this.length;b<a;b++){if(b in this){c.call(d,this[b],b,this)}}}}(function(a){Math.old_random=a;Math.random=function(c,b){if(arguments.length==2){return Math.floor(a()*(b-c+1)+c)}else{return a()}}})(Math.random);Number.prototype.times=function(b,c){for(var a=0;a<this;a++){b.call(c,a,this)}};Object.prototype.alias=function(b,a){this[a]=this[b]};if(!"keys" in Object){Object.keys=function(a){var c=new Array();for(var b in a){if(a.hasOwnProperty(b)){c.push(b)}}return c}}if(typeof Object.getPrototypeOf!=="function"){if(typeof"test".__proto__==="object"){Object.getPrototypeOf=function getPrototypeOf(a){return a.__proto__}}else{Object.getPrototypeOf=function getPrototypeOf(a){return a.constructor.prototype}}}Object.setPrototypeOf=(function(){if({}.__proto__){return function a(c,b){c.__proto__=b;return c}}else{return function a(d,b){for(var c in b){d.constructor.prototype[c]=b[c]}return d}}})();var Var={isEnumerable:function(a){return(a!=null&&typeof a.length=="number"&&toString.call(a)!="[object Function]")},isDefined:function(a){return typeOf(a)!="undefined"},isObject:function(a){return typeOf(a)=="object"},isArray:function(a){return typeOf(a)=="array"},isRegExp:function(a){return typeOf(a)=="regexp"},isDate:function(a){return typeOf(a)=="date"},isBoolean:function(a){return typeOf(a)=="boolean"},isBool:function(a){return this.isBoolean(a)},isNumber:function(a){return typeOf(a)=="number"},isNull:function(a){return typeOf(a)=="null"},isNaN:function(a){return typeOf(a).toLowerCase()=="nan"},isElement:function(a){return(a instanceof HTMLElement)}};